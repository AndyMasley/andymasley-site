---
import Base from '@/layouts/Base.astro';
import { fetchSubstackPosts } from '@/lib/substack';
import { getMetaPostSlugs } from '@/lib/meta-posts';

// Fetch recent blog posts from Substack
const allPosts = await fetchSubstackPosts();
const metaSlugs = getMetaPostSlugs();
const recentPosts = allPosts
  .filter(p => !metaSlugs.includes(p.slug))
  .slice(0, 4);

function formatDate(date: Date): string {
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  return `${month}.${day}`;
}
---

<Base title="Home">
  <div class="home-intro">
    <p>
      I'm the director of <a href="https://effectivealtruismdc.org" target="_blank" rel="noopener">Effective Altruism DC</a> and spend a lot of time thinking about how to support the EA DC professional network and manage projects and people to make it better. More info about EA <a href="https://www.effectivealtruism.org/" target="_blank" rel="noopener">here</a>. Outside of my job I spend most of my time with friends, reading, watching movies, listening to music, and exercising. I use this site as a place to link to stuff I make or that I'm interested in.
    </p>
    <p>
      Before EA DC I was a high school physics teacher for 7 years. I have all my physics resources on <a href="/physics">this page</a>. I made animated video lectures for each day of my 2 year IB physics course which I host on my <a href="https://www.youtube.com/@andymasley" target="_blank" rel="noopener">YouTube channel</a>.
    </p>
    <p>
      I also <a href="https://andymasley.substack.com" target="_blank" rel="noopener">blog</a> and <a href="https://x.com/AndyMasley" target="_blank" rel="noopener">tweet</a> a lot. You can follow my full media empire <a href="https://substack.com/@andymasley" target="_blank" rel="noopener">here</a>.
    </p>
    <p>
      Email me at <a href="mailto:AndyMasley@gmail.com">AndyMasley@gmail.com</a> if you'd like to chat! If you'd like to talk about anything related to EA DC please email <a href="mailto:Andy@EffectiveAltruismDC.org">Andy@EffectiveAltruismDC.org</a>. You can also connect with me on <a href="https://www.linkedin.com/in/andrew-masley/" target="_blank" rel="noopener">LinkedIn</a>. You can leave me anonymous feedback <a href="https://docs.google.com/forms/d/e/1FAIpQLSfeuR0zagnxjzyNQvh6OkI8pRd9Vtq26D8RzJ2h8WZYlaz8Sw/viewform?usp=dialog" target="_blank" rel="noopener">here</a>.
    </p>
  </div>

  <hr class="divider" />

  <div class="home-recent">
    <div class="label">Recent</div>
    <ul class="content-list">
      {recentPosts.map(post => (
        <li class="content-item">
          <span class="content-item__date">{formatDate(post.date)}</span>
          <a href={`/writing/${post.slug}`} class="content-item__link">
            {post.title}
          </a>
        </li>
      ))}
    </ul>
  </div>

  <hr class="divider" />

  <div class="home-elsewhere">
    <span class="label">Elsewhere: </span>
    <a href="https://substack.com/@andymasley" target="_blank" rel="noopener">Substack</a>
    <span class="header__nav-sep"> · </span>
    <a href="https://x.com/AndyMasley" target="_blank" rel="noopener">Twitter</a>
    <span class="header__nav-sep"> · </span>
    <a href="https://bsky.app/profile/andymasley.bsky.social" target="_blank" rel="noopener">Bluesky</a>
    <span class="header__nav-sep"> · </span>
    <a href="https://www.linkedin.com/in/andrew-masley/" target="_blank" rel="noopener">LinkedIn</a>
    <span class="header__nav-sep"> · </span>
    <a href="https://www.youtube.com/@andymasley" target="_blank" rel="noopener">YouTube</a>
    <span class="header__nav-sep"> · </span>
    <a href="https://www.youtube.com/@Andyonsuno" target="_blank" rel="noopener">AI Songs</a>
    <span class="header__nav-sep"> · </span>
    <a href="https://www.goodreads.com/andymasley" target="_blank" rel="noopener">Goodreads</a>
    <span class="header__nav-sep"> · </span>
    <a href="https://letterboxd.com/andymasley/" target="_blank" rel="noopener">Letterboxd</a>
    <span class="header__nav-sep"> · </span>
    <a href="/rss.xml">RSS</a>
  </div>
</Base>
