---
import Base from '@/layouts/Base.astro';
import { getCollection } from 'astro:content';

const allWriting = await getCollection('writing', ({ data }) => !data.draft);
const allMusic = await getCollection('music', ({ data }) => !data.draft);
const allNotes = await getCollection('notes', ({ data }) => !data.draft);
const allPhysics = await getCollection('physics', ({ data }) => !data.draft);

// Combine recent items
const recentItems = [
  ...allWriting.map(p => ({ ...p, type: 'writing', url: `/writing/${p.slug}` })),
  ...allMusic.map(p => ({ ...p, type: 'music', url: `/music/${p.slug}` })),
  ...allNotes.map(p => ({ ...p, type: 'notes', url: `/notes/${p.slug}` })),
].sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf()).slice(0, 5);

function formatDate(date: Date): string {
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  return `${year}.${month}.${day}`;
}
---

<Base title="Home">
  <div class="home-intro">
    <p>
      I'm the director of <a href="https://effectivealtruismdc.org" target="_blank" rel="noopener">Effective Altruism DC</a> and spend a lot of time thinking about how to support the EA DC professional network and manage projects and people to make it better. More info about EA <a href="https://www.effectivealtruism.org/" target="_blank" rel="noopener">here</a>. Outside of my job I spend most of my time with friends, reading, watching movies, listening to music, and exercising. I use this site as a place to link to stuff I make or that I'm interested in.
    </p>
    <p>
      Before EA DC I was a high school physics teacher for 7 years. I have all my physics resources on <a href="/physics">this page</a>. I made animated video lectures for each day of my 2 year IB physics course which I host on my <a href="https://www.youtube.com/@andymasley" target="_blank" rel="noopener">YouTube channel</a>.
    </p>
    <p>
      I also blog and tweet a lot. You can follow my full media empire <a href="https://substack.com/@andymasley" target="_blank" rel="noopener">here</a>.
    </p>
    <p>
      Email me at <a href="mailto:AndyMasley@gmail.com">AndyMasley@gmail.com</a> if you'd like to chat! If you'd like to talk about anything related to EA DC please email <a href="mailto:Andy@EffectiveAltruismDC.org">Andy@EffectiveAltruismDC.org</a>. You can also connect with me on <a href="https://www.linkedin.com/in/andymasley/" target="_blank" rel="noopener">LinkedIn</a>. You can leave me anonymous feedback <a href="https://www.admonymous.co/andymasley" target="_blank" rel="noopener">here</a>.
    </p>
  </div>

  <hr class="divider" />

  <div class="home-sections">
    <div class="label">Sections</div>
    <a href="/writing">Writing</a> — essays on AI, economics, EA<br/>
    <a href="/physics">IB Physics</a> — video lectures, full curriculum<br/>
    <a href="/notes">Notes</a> — ideas, TILs, references, quotes<br/>
    <a href="/music">Media Recs</a> — albums, films, books<br/>
  </div>

  <hr class="divider" />

  <div class="home-recent">
    <div class="label">Recent</div>
    <ul class="content-list">
      {recentItems.map(item => (
        <li class="content-item">
          <span class="content-item__date">{formatDate(item.data.date)}</span>
          <a href={item.url} class="content-item__link">
            {item.data.title || item.data.album}
          </a>
        </li>
      ))}
    </ul>
  </div>

  <hr class="divider" />

  <div class="home-elsewhere">
    <span class="label">Elsewhere: </span>
    <a href="https://substack.com/@andymasley" target="_blank" rel="noopener">Substack</a>
    <span class="header__nav-sep"> · </span>
    <a href="https://x.com/AndyMasley" target="_blank" rel="noopener">Twitter</a>
    <span class="header__nav-sep"> · </span>
    <a href="https://www.youtube.com/@andymasley" target="_blank" rel="noopener">YouTube</a>
    <span class="header__nav-sep"> · </span>
    <a href="/rss.xml">RSS</a>
  </div>
</Base>
